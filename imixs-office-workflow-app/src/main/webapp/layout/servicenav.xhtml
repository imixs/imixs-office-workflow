<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://xmlns.jcp.org/jsf/passthrough">

	<f:view>
		<h:form>
			<!-- Branding -->
			<div class="toolbar branding">
				<h:commandLink actionListener="#{workflowController.close}"
					immediate="true" title="home"
					action="/pages/notes?faces-redirect=true">
					<span>#{app.application_title}</span>
				</h:commandLink>
			</div>



			<!-- settings -->
			<h:panelGroup layout="block" styleClass="toolbar settings"
				rendered="#{loginController.authenticated}">
				<h:commandLink actionListener="#{workflowController.close}"
					immediate="true" title="home"
					action="/pages/notes?faces-redirect=true">
					<span class="typcn typcn-home"></span>
				</h:commandLink>
			</h:panelGroup>


			<!-- Login -->
			<h:panelGroup layout="block" styleClass="toolbar login"
				rendered="#{loginController.authenticated}">

				<span class="login-name"> <h:outputText
						value="#{message.signed_in}: " /> <h:outputText
						rendered="#{! empty userController.workitem.item['txtUserName']}"
						value="#{userController.workitem.item['txtUserName']}" /> <h:outputText
						rendered="#{empty userController.workitem.item['txtUserName']}"
						value="#{userController.workitem.item['txtName']}" />
				</span>
				<h:link outcome="/pages/profile/settings"
					title="#{message['nav.my_settings']}">
					<span class="typcn typcn-cog"></span>
				</h:link>
				<h:commandLink action="logout" immediate="true"
					title="#{message['nav.logout']}"
					actionListener="#{loginController.doLogout}"><span class="typcn typcn-power"></span></h:commandLink>
			</h:panelGroup>


			<!-- Search -->
			<c:if test="#{loginController.authenticated}">

				<div class="toolbar search">
					<input type="text" style="margin-right: 10px;" id="search_input"
						placeholder="#{message.search}..." onfocus="this.value='';" /><a id="search_link" href="#"><span
						class="typcn typcn-zoom-outline"></span></a>
				</div>


				<!-- Tasklist Board -->
				<div class="toolbar">
					<!-- board -->
					<h:commandLink action="board" immediate="true"
						actionListener="#{boardController.reset}">
						<span class="typcn typcn-th-large-outline"></span>
						<f:setPropertyActionListener target="#{boardController.title}"
							value="#{message['worklist.owner']}" />
					</h:commandLink>
				</div>

				<!-- DMS Search -->
				<h:panelGroup layout="block" styleClass="toolbar"
					rendered="#{propertyController.getProperty('dms.search') eq 'true'}">
					<h:link outcome="/pages/workitems/dms_search" title="#{message['nav.search_documents']}">
						<span class="typcn typcn-archive"></span>
					</h:link>
				</h:panelGroup>

				<!-- Custom Section -->
				<ui:include src="servicenav_custom.xhtml" />
			</c:if>


			<!-- About Section -->
			<ui:include src="servicenav_about.xhtml" />

		</h:form>

	</f:view>

	<script type="text/javascript">
		/*<![CDATA[*/
			
		$(document).ready(function() {
			$("#search_link").click(function(e) {
				e.preventDefault();
				var phrase = $("#search_input").val();
				var url = "/pages/workitems/worklist.xhtml?_phrase=" + phrase;
				window.location.href= url;
			});
			
			$("#search_input").keydown(function(e){
			    if(e.keyCode == 13) {
			    	$("#search_link").click();
			    	return false;
			    }
			});
		});

		/*]]>*/
	</script>
</ui:composition>


